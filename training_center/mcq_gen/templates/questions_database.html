{% extends "base.html" %}
{% block content %}
    <link rel="stylesheet"
          href="https://cdn.datatables.net/1.11.5/css/jquery.dataTables.min.css">
    <div class="container px-5 mt-4 bg-light">
        <div class="row">
            <div class="col-sm">
                <form action="" method="post" enctype="multipart/form-data">
                    {% csrf_token %}
                    {{ filter_form }}
                    <label for="">Ata chapter:</label>
                    <div class="row" id='ata_checkboxes'>
                        {% for ata in atas %}
                            <div class="col-1">
                                <label for="{{ ata.ata_digit }}">{{ ata.ata_digit }}</label>
                                <input class="form-check-input"
                                       type="checkbox"
                                       name="{{ ata.ata_digit }}"
                                       id="{{ ata.ata_digit }}">
                            </div>
                        {% endfor %}
                    </div>
                    <input type="submit" value="Filter" class="btn btn-primary mt-3">
                </form>
            </div>
            <div class = "col-sm">
                <a href="{% url 'create_question' %}" class="btn btn-warning mt-3">Create new question</a>
                <div class="card mt-3"  id="general_info">
                    <div class="card-header">General information</div>
                    <ul class="list-group list-group-flush">
                        <li class="list-group-item">Training: {{ training_name }}</li>
                        <li class="list-group-item">Selected ATA Chapters: {{ atas_list }}</li>
                        <li class="list-group-item">Questions count: {{ questions_count }}</li>
                    </ul>
                </div>
            </div>
        </div>
        {{ questions_table | safe }}
    </div>
{% endblock content %}
{% block scripts %}
    <script type="text/javascript" language="javascript" class="init">
    $('#general_info').hide()
    {% if questions_count > 0 %}
        $('#general_info').show()
    {% else %}
        $('#general_info').hide()
    {% endif %}
        
    $(document).ready(function() {
        var table = $('#questions_database').dataTable( {
            paging: false,
            scrollY: 400,
            scrollCollapse: true,
            fixedColumns: true,
            dom: 'Bfrtip',
            
        } );
        
        
        $(document).on('click','#questions_database tr',function(e){
            var row_object  = table.api().row(this).data();
            var url = "{% url 'question_details' 123 %}"
            url = url.replace('123', row_object[1])
            
            window.open(url, '_blank');
           
        });
    } );
    </script>
{% endblock scripts %}
